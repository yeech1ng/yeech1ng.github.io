---
title: "Final Project: What makes K-Dramas so popular globally?"
---

![watching dramas](images/finalproj_1){width="900"}

# Introduction

```{r, eval=TRUE, echo=FALSE}

suppressMessages({
  suppressWarnings({
    library(ggplot2)
    library(RColorBrewer)
    library(plotly, warn.conflicts = FALSE)
    

# Read the CSV file
kdrama_pop_2022 <- read.csv("datasets/k-drama-popularity-worldwide-2022.csv", fill=TRUE)

# Define custom order for the levels of the "Popularity" variable
popularity_order <- c("Very popular", "Moderately popular", "Slightly popular", "Not popular")
kdrama_pop_2022$Popularity <- factor(kdrama_pop_2022$Popularity, levels = popularity_order)

# Create a vector of colors for the bars
colors <- brewer.pal(4, "Set2") 

# Create the bar plot with specified colors and custom order
bp1 <- ggplot(kdrama_pop_2022, aes(x = Popularity, y = Percentage, fill = Popularity)) +
  geom_bar(stat = "identity") +
  labs(title = "K-Drama Popularity Worldwide in 2022", x = "Popularity", y = "Percentage", caption = "Source: Statista") +
  theme_bw() +
  scale_fill_manual(values = colors)

ggplotly(bp1)

  })
})
```

# Comparison with Japanese and Thai Dramas

## 1. Ratings

```{r, eval=TRUE, echo=FALSE}
suppressMessages({
  suppressWarnings({
    library(ggplot2)
    library(RColorBrewer)
    library(tidyverse)
  
top_5000dramas <- read.csv("datasets/top_5000_dramas.csv")

top_5000dramas_filtered <- top_5000dramas %>%
  filter(released_year >= 2018 & grepl("Japanese|Thai|Korean", Language))

colors <- brewer.pal(3, "Set2") 

# Calculate average ratings for each language
avg_ratings <- top_5000dramas_filtered %>%
  group_by(Language) %>%
  summarize(avg_rating = mean(Rating, na.rm = TRUE))

# Create a bar plot
bp2 <- ggplot(avg_ratings, aes(x = Language, y = avg_rating, fill = Language)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Ratings of Thai, Japanese, and Korean Dramas from 2018 to 2023",
       x = "Language", y = "Average Rating") +
  theme_bw() + scale_fill_manual(values = colors)

ggplotly(bp2)

  })
})

```

```{r, eval=FALSE, echo=FALSE}
general_kdrama <- read.csv("datasets/kor_drama.csv")
general_kdrama_2018to2023 <- general_kdrama %>% filter(year >= 2018 & year <= 2023)

ggplot(general_kdrama_2018to2023, aes(x = year, y = tot_user_score)) +
  geom_point() +
  labs(title = "K-Drama Ratings from 2018 to 2023 ", x = "Time", y = "Ratings") + theme_bw()

```

test test test

```{=html}
<iframe height="400" width="100%" frameborder="no" src="https://yeech1ng.shinyapps.io/sample_app/ "> </iframe>
```
